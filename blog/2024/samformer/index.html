<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> SAMformer | </title> <meta name="author" content=" "> <meta name="description" content="TODO"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://logb-wip.github.io/blog/2024/samformer/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "SAMformer",
            "description": "TODO",
            "published": "October 11, 2024",
            "authors": [
              
              {
                "author": "Ambroise Odonnat",
                "authorURL": "https://ambroiseodt.github.io/",
                "affiliations": [
                  {
                    "name": "Huawei Noah's Ark Lab",
                    "url": ""
                  }
                ]
              },
              
              {
                "author": "Oussama Zekri",
                "authorURL": "https://oussamazekri.fr",
                "affiliations": [
                  {
                    "name": "ENS Paris-Saclay",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>SAMformer</h1> <p>TODO</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#goal">Goal üöÄ</a> </div> <div> <a href="#trainability-issues-due-to-the-attention">Trainability Issues due to the Attention üîé</a> </div> <div> <a href="#samformer-in-depth-%EF%B8%8F">SAMformer in-depth ‚öîÔ∏è</a> </div> <div> <a href="#getting-your-hands-dirty-%EF%B8%8F">Getting your hands dirty üñ•Ô∏è</a> </div> <div> <a href="#acknowledgments">Acknowledgments üôèüèæ</a> </div> </nav> </d-contents> <h2 id="goal-"> <a id="goal"></a>Goal üöÄ</h2> <blockquote> <p>Fear not, those who delved into the maths of the kernel trick, for its advent in deep learning is coming.</p> </blockquote> <p>In this blog post, we focus on the <strong><em>Convolutional Kernel Network</em></strong> (CKN) architecture proposed in <a href="https://proceedings.neurips.cc/paper_files/paper/2016/file/fc8001f834f6a5f0561080d134d53d29-Paper.pdf" rel="external nofollow noopener" target="_blank"><em>End-to-End Kernel Learning with Supervised Convolutional Kernel Networks</em></a> <d-cite key="mairal2016endtoend"></d-cite> and present its guiding principles and main components. TODO</p> <h2 id="trainability-issues-due-to-the-attention-">Trainability Issues due to the Attention üîé</h2> <p>Before diving into the CKN itself, we briefly recall what the <em>kernel trick</em> stands for. TODO</p> \[\begin{equation*} K(\mathbf{x}, \mathbf{x}') = \langle \varphi(\mathbf{x}), \varphi(\mathbf{x}')\rangle_{\mathcal{H}} \end{equation*}\] <h2 id="samformer-in-depth-Ô∏è">SAMformer in-depth ‚öîÔ∏è</h2> <p>Now that everyone has a clear head regarding the kernel trick, we are prepared to introduce the so-called <strong><em>Convolutional Kernel Network</em></strong>. The main idea behind the CKN is to leverage the kernel trick to represent local neighborhoods of images. In this section, we explain how the authors build Convolutional Kernel layers that can be stacked into a multi-layer CKN.</p> <h3 id="motivation-representing-local-image-neighborhoods">Motivation: representing local image neighborhoods</h3> <p>The CKN architecture is a type of convolutional neural network that couples the prediction task with representation learning.</p> <h2 id="getting-your-hands-dirty-Ô∏è">Getting your hands dirty üñ•Ô∏è</h2> <p>In this section, we discuss the implementation of the CKN architecture and show how to reimplement it from scratch.</p> <h3 id="modern-implementation">Modern Implementation</h3> <p>The original implementation of the CKN architecture makes use of modern deep learning frameworks such as <code class="language-plaintext highlighter-rouge">PyTorch</code>, <code class="language-plaintext highlighter-rouge">TensorFlow</code> or <code class="language-plaintext highlighter-rouge">JAX</code> and can be found <a href="https://github.com/claying/CKN-Pytorch-image" rel="external nofollow noopener" target="_blank">here</a>. We recommend using it if the performance is at stake.</p> <h4 id="autodiff">Autodiff</h4> <p>Automatic differentiation (autodiff) is a well-known algorithm that is absolutely essential in deep learning.</p> <div style="display: flex; justify-content: center;"> <blockquote class="twitter-tweet"> <p lang="en" dir="ltr">Backprop in neural networks is reverse mode auto-diff applied to a simple linear computational graph. The simplicity of the resulting algorithm somehow overshadows the power and non-triviality of applying auto-diff to complex (e.g. recursive) graphs. <a href="https://t.co/5op8P7oYrE" rel="external nofollow noopener" target="_blank">https://t.co/5op8P7oYrE</a> <a href="https://t.co/ETafufgGqa" rel="external nofollow noopener" target="_blank">pic.twitter.com/ETafufgGqa</a></p>‚Äî Gabriel Peyr√© (@gabrielpeyre) <a href="https://twitter.com/gabrielpeyre/status/956932467092574213?ref_src=twsrc%5Etfw" rel="external nofollow noopener" target="_blank">January 26, 2018</a> </blockquote> <script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script> </div> <p>For implementation from scratch details of autodiff, see this really simple <a href="https://e-dorigatti.github.io/math/deep%20learning/2020/04/07/autodiff.html" rel="external nofollow noopener" target="_blank">blog post</a> from <a href="https://e-dorigatti.github.io/" rel="external nofollow noopener" target="_blank">Emilio Dorigatti</a>‚Äôs website. But let‚Äôs go back to our CKN now.</p> <h2 id="acknowledgments-"> <a id="acknowledgments"></a>Acknowledgments üôèüèæ</h2> <p>We would especially like to thank Prof. <a href="https://lear.inrialpes.fr/people/mairal/" rel="external nofollow noopener" target="_blank">Julien Mairal</a> for taking the time to proofread this blog post. This is all the more important to us as he is the author of the <a href="https://proceedings.neurips.cc/paper_files/paper/2016/file/fc8001f834f6a5f0561080d134d53d29-Paper.pdf" rel="external nofollow noopener" target="_blank">CKN paper</a>. We are very grateful to the professors of the <a href="https://mva-kernel-methods.github.io/course-2023-2024/" rel="external nofollow noopener" target="_blank">Kernel Methods course</a> of the <a href="https://www.master-mva.com/" rel="external nofollow noopener" target="_blank">MVA Master</a>: Prof. <a href="https://lear.inrialpes.fr/people/mairal/" rel="external nofollow noopener" target="_blank">Julien Mairal</a>, Prof. <a href="https://michaelarbel.github.io/" rel="external nofollow noopener" target="_blank">Michel Arbel</a>, Prof. <a href="https://jpvert.github.io/" rel="external nofollow noopener" target="_blank">Jean-Philippe Vert</a> and Prof. <a href="https://www.di.ens.fr/~rudi/" rel="external nofollow noopener" target="_blank">Alessandro Rudi</a> for introducing us to this field.</p> <p>For any further questions, please feel free to leave a comment or contact us by mail!</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/2024-10-11-samformer.bib"></d-bibliography> <div id="giscus_thread" style="max-width: 930px; margin: 0 auto;"> <script>let giscusTheme=determineComputedTheme(),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"logb-wip/logb-wip.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> ¬© Copyright 2024 . </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> </body> </html>